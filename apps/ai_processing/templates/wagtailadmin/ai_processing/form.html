{% extends "wagtailadmin/base.html" %}
{% load i18n %}

{% block titletag %}{% trans "Process URL with AWS Bedrock" %}{% endblock %}

{% block extra_js %}
<script type="text/javascript">
    document.addEventListener('DOMContentLoaded', function() {
        // Get the radio buttons and form fields
        var selectorChoiceInputs = document.querySelectorAll('input[name="selector_choice"]');
        var configField = document.querySelector('.field-selector_configuration');
        var manualField = document.querySelector('.field-css_selectors');
        
        // Function to show/hide fields based on selected radio button
        function updateVisibility() {
            var selectedValue = document.querySelector('input[name="selector_choice"]:checked').value;
            
            if (selectedValue === 'config') {
                configField.style.display = 'block';
                manualField.style.display = 'none';
            } else {
                configField.style.display = 'none';
                manualField.style.display = 'block';
            }
        }
        
        // Set initial visibility
        updateVisibility();
        
        // Add event listeners to the radio buttons
        selectorChoiceInputs.forEach(function(input) {
            input.addEventListener('change', updateVisibility);
        });
    });
</script>
{% endblock %}

{% block content %}
    <div class="nice-padding">
        <h1>{% trans "Process URL with AWS Bedrock" %}</h1>
        
        <p>{% trans "Enter a URL to process with AWS Bedrock AI. The URL will be analyzed to extract structured information." %}</p>
        
        <form action="{% url 'ai_processing:process_url' %}" method="POST">
            {% csrf_token %}
            
            <ul class="fields">
                <!-- URL field always visible -->
                <li>
                    <div class="field {{ form.url.field.widget.attrs.class }}">
                        {{ form.url.errors }}
                        {{ form.url.label_tag }}
                        {{ form.url }}
                        {% if form.url.help_text %}
                        <p class="help">{{ form.url.help_text }}</p>
                        {% endif %}
                    </div>
                </li>
                
                <!-- Selector choice field -->
                <li>
                    <div class="field">
                        {{ form.selector_choice.errors }}
                        <label>{% trans "Selector Type" %}</label>
                        {{ form.selector_choice }}
                        {% if form.selector_choice.help_text %}
                        <p class="help">{{ form.selector_choice.help_text }}</p>
                        {% endif %}
                    </div>
                </li>
                
                <!-- Selector configuration field (initially may be hidden) -->
                <li>
                    <div class="field field-selector_configuration {{ form.selector_configuration.field.widget.attrs.class }}">
                        {{ form.selector_configuration.errors }}
                        {{ form.selector_configuration.label_tag }}
                        {{ form.selector_configuration }}
                        {% if form.selector_configuration.help_text %}
                        <p class="help">{{ form.selector_configuration.help_text }}</p>
                        {% endif %}
                    </div>
                </li>
                
                <!-- CSS selectors field (initially may be hidden) -->
                <li>
                    <div class="field field-css_selectors {{ form.css_selectors.field.widget.attrs.class }}">
                        {{ form.css_selectors.errors }}
                        {{ form.css_selectors.label_tag }}
                        {{ form.css_selectors }}
                        {% if form.css_selectors.help_text %}
                        <p class="help">{{ form.css_selectors.help_text }}</p>
                        {% endif %}
                    </div>
                </li>
            </ul>
            
            <input type="submit" value="{% trans 'Process URL' %}" class="button" />
        </form>
    </div>
{% endblock %} 